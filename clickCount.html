<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ ULTIMATE AUTOMATION POWERHOUSE</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            color: #856404;
            font-weight: bold;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid #e9ecef;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #dee2e6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #4a5568;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #718096;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .status-running {
            background: #48bb78;
            animation: pulse 1.5s infinite;
        }
        
        .status-stopped {
            background: #f56565;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-icon {
            font-size: 1.2rem;
        }
        
        #startBtn {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
        }
        
        #startBtn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(56, 161, 105, 0.4);
        }
        
        #stopBtn {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            color: white;
        }
        
        #stopBtn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(229, 62, 62, 0.4);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        #resetBtn {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
        }
        
        #resetBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(49, 130, 206, 0.4);
        }
        
        .storage-btn {
            background: linear-gradient(135deg, #805ad5 0%, #6b46c1 100%);
            color: white;
        }
        
        .storage-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(107, 70, 193, 0.4);
        }
        
        .link-section {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #edf2f7;
            border-radius: 10px;
        }
        
        #testLink {
            display: inline-block;
            padding: 15px 30px;
            background: #4a5568;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }
        
        #testLink:hover {
            background: #2d3748;
            transform: translateY(-2px);
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }
        
        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        label {
            font-weight: 600;
            color: #4a5568;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .label-icon {
            font-size: 1.1rem;
        }
        
        input[type="number"], input[type="url"], select {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        input[type="number"]:focus, input[type="url"]:focus, select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }
        
        .advanced-section {
            margin-top: 25px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .advanced-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            margin-bottom: 15px;
        }
        
        .advanced-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
        }
        
        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #4299e1;
        }
        
        .log-container {
            margin-top: 25px;
        }
        
        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .log {
            background: #1a202c;
            color: #cbd5e0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            height: 250px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-size: 0.9rem;
        }
        
        .log-entry {
            padding: 8px 0;
            border-bottom: 1px solid #2d3748;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .log-time {
            color: #68d391;
            min-width: 70px;
        }
        
        .log-type {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .log-type-info { background: #2b6cb0; color: white; }
        .log-type-success { background: #276749; color: white; }
        .log-type-warning { background: #975a16; color: white; }
        .log-type-error { background: #c53030; color: white; }
        
        .log-message {
            color: #cbd5e0;
            flex: 1;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #718096;
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }
        
        .data-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #48bb78;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .data-status.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Health status panel */
        .health {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #1a202c;
            color: #68d391;
            padding: 10px 14px;
            border-radius: 10px;
            font-size: 0.85rem;
            box-shadow: 0 8px 20px rgba(0,0,0,.25);
            z-index: 1000;
        }
        
        .health span {
            color: #fff;
        }
        
        /* Progress bar */
        .progress-container {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 5px;
            margin: 10px 0;
            height: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #4299e1);
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
            
            .data-status {
                bottom: 10px;
                right: 10px;
                left: 10px;
                text-align: center;
            }
            
            .health {
                position: relative;
                top: 0;
                right: 0;
                margin-bottom: 20px;
                text-align: center;
            }
        }
        
        /* Scrollbar styling */
        .log::-webkit-scrollbar {
            width: 8px;
        }
        
        .log::-webkit-scrollbar-track {
            background: #2d3748;
            border-radius: 4px;
        }
        
        .log::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 4px;
        }
        
        .log::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
    </style>
</head>
<body>
    <!-- Health status panel -->
    <div class="health">
        Status: <span id="healthStatus">OK</span><br>
        Heartbeat: <span id="heartbeat">0</span><br>
        Performance: <span id="performanceScore">100%</span>
    </div>

    <div class="container">
        <h1>üöÄ ULTIMATE AUTOMATION POWERHOUSE</h1>
        <div class="subtitle">Enterprise-Grade Automation ‚Ä¢ Military Security ‚Ä¢ AI Optimization</div>
        
        <div class="warning">
            ‚ö†Ô∏è ADVANCED AUTOMATION PLATFORM - EDUCATIONAL USE ONLY<br>
            Use only on your own websites or with explicit written permission
        </div>
        
        <div class="control-panel">
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">Total Operations</div>
                    <div id="totalClicks" class="stat-value">0</div>
                    <small id="savedClicks">(IndexedDB: 0)</small>
                    <div class="progress-container">
                        <div class="progress-bar" id="clickProgress" style="width: 0%"></div>
                    </div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">System Status</div>
                    <div id="status" class="stat-value">
                        <span class="status-indicator status-stopped"></span>
                        IDLE
                    </div>
                    <small id="uptime">Uptime: 0s</small>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Session Duration</div>
                    <div id="sessionTime" class="stat-value">0s</div>
                    <small id="totalTime">Total: 0s</small>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Success Rate</div>
                    <div id="successRate" class="stat-value">100%</div>
                    <small id="failedClicks">Failed: 0</small>
                </div>
            </div>
            
            <div class="buttons">
                <button id="startBtn" onclick="startAutomation()">
                    <span class="btn-icon">üöÄ</span>
                    LAUNCH AUTOMATION
                </button>
                <button id="stopBtn" onclick="stopAutomation()" disabled>
                    <span class="btn-icon">‚èπÔ∏è</span>
                    EMERGENCY STOP
                </button>
                <button id="resetBtn" onclick="resetStats()">
                    <span class="btn-icon">üîÑ</span>
                    RESET ALL
                </button>
                <button class="storage-btn" onclick="exportData()">
                    <span class="btn-icon">üíæ</span>
                    EXPORT DATA
                </button>
                <button class="storage-btn" onclick="importData()">
                    <span class="btn-icon">üì•</span>
                    IMPORT DATA
                </button>
            </div>
            
            <div class="settings-grid">
                <div class="setting-group">
                    <label>
                        <span class="label-icon">‚ö°</span>
                        Operation Speed (ms):
                    </label>
                    <input type="number" id="clickDelay" min="100" max="10000" value="2000" step="100">
                    <input type="range" id="speedRange" min="100" max="10000" value="2000" step="100" 
                           oninput="updateSpeedValue(this.value)">
                    <small>Current: <span id="speedValue">2000ms</span></small>
                </div>
                <div class="setting-group">
                    <label>
                        <span class="label-icon">üéØ</span>
                        Max Operations (0 = ‚àû):
                    </label>
                    <input type="number" id="maxClicks" min="0" max="100000" value="100">
                </div>
                <div class="setting-group">
                    <label>
                        <span class="label-icon">üåê</span>
                        Target URL:
                    </label>
                    <input type="url" id="targetUrl" value="https://example.com" placeholder="https://your-site.com">
                </div>
                <div class="setting-group">
                    <label>
                        <span class="label-icon">‚ÜóÔ∏è</span>
                        Open Link In:
                    </label>
                    <select id="openInNewTab">
                        <option value="_blank">New Tab</option>
                        <option value="_self">Same Tab</option>
                        <option value="_parent">Parent Frame</option>
                    </select>
                </div>
            </div>
            
            <div class="advanced-section">
                <div class="advanced-header" onclick="toggleAdvanced()">
                    <h3>‚öôÔ∏è ADVANCED CONTROLS</h3>
                    <span id="advancedToggle">‚ñº</span>
                </div>
                <div id="advancedContent" class="advanced-content" style="display: none;">
                    <div class="checkbox-group">
                        <input type="checkbox" id="autoResume" checked>
                        <label for="autoResume">üîÑ Auto-resume on reload</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="saveLogs" checked>
                        <label for="saveLogs">üìä Persistent logs</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="notifications" checked>
                        <label for="notifications">üîî Desktop notifications</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="randomDelay" checked>
                        <label for="randomDelay">üé≤ ¬±20% random delay</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="autoSave" checked>
                        <label for="autoSave">üíæ Auto-save every 30s</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="soundEffects">
                        <label for="soundEffects">üîä Sound effects</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="useIndexedDB" checked>
                        <label for="useIndexedDB">üóÑÔ∏è Use IndexedDB (enterprise)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="useWebWorker" checked>
                        <label for="useWebWorker">ü§ñ Use Web Worker (multithreaded)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="stealthMode">
                        <label for="stealthMode">üïµÔ∏è Stealth mode</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="aiOptimization" checked>
                        <label for="aiOptimization">üß† AI Performance Optimization</label>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="link-section">
            <h3>üéØ TARGET OPERATIONS</h3>
            <a id="testLink" href="https://example.com" target="_blank">
                üîó AUTO-CLICK SIMULATION (Active)
            </a>
            <div style="margin-top: 10px; font-size: 0.9rem; color: #718096;">
                Opens in: <span id="linkTargetPreview">New Tab</span> ‚Ä¢ 
                Next click in: <span id="nextClickTimer">--</span> seconds
            </div>
        </div>
        
        <div class="log-container">
            <div class="log-header">
                <h3>üìã SYSTEM LOGS</h3>
                <div>
                    <button onclick="clearLogs()" style="padding: 8px 15px; font-size: 0.9rem; margin-right: 10px;">
                        üßπ Clear Logs
                    </button>
                    <button onclick="exportLogs()" style="padding: 8px 15px; font-size: 0.9rem;">
                        üì§ Export Logs
                    </button>
                </div>
            </div>
            <div class="log" id="activityLog">
                <!-- Log entries will appear here -->
            </div>
        </div>
        
        <div class="footer">
            <div>üöÄ Enterprise Automation Platform v3.0 ‚Ä¢ üõ°Ô∏è Military-Grade Security ‚Ä¢ ü§ñ AI-Optimized</div>
            <div style="margin-top: 10px; font-size: 0.8rem;">
                Last saved: <span id="lastSaved">Never</span> | 
                Storage: <span id="storageUsed">0 KB</span> |
                DB Status: <span id="dbStatus">IndexedDB Ready</span> |
                Threads: <span id="threadStatus">1 Active</span>
            </div>
        </div>
    </div>

    <div class="data-status" id="dataStatus"></div>

    <script>
        // ============================================
        // ENTERPRISE CONFIGURATION
        // ============================================
        const CONFIG = {
            VERSION: '3.0.0',
            APP_NAME: 'Ultimate Automation Powerhouse',
            
            // Performance
            MAX_CLICKS: 100000,
            MIN_DELAY: 100,
            MAX_DELAY: 10000,
            
            // Storage
            INDEXEDDB_VERSION: 3,
            INDEXEDDB_NAME: 'automation_enterprise_v3'
        };

        // ============================================
        // ENTERPRISE WEB WORKER
        // ============================================
        const workerCode = `
            let timer = null;
            let nextClickTime = 0;
            let operationId = 0;
            
            self.onmessage = function(e) {
                const { cmd, data } = e.data;
                
                switch(cmd) {
                    case 'start':
                        clearInterval(timer);
                        const { delay, useAI } = data;
                        nextClickTime = Date.now() + delay;
                        
                        timer = setInterval(() => {
                            operationId++;
                            const currentTime = Date.now();
                            const timeUntilNext = nextClickTime - currentTime;
                            
                            // Send tick with operation details
                            self.postMessage({
                                type: 'tick',
                                operationId,
                                timestamp: currentTime,
                                timeUntilNext: Math.max(0, timeUntilNext)
                            });
                            
                            // Calculate next click time
                            let nextDelay = delay;
                            
                            // AI optimization - adjust timing dynamically
                            if (useAI) {
                                const variation = Math.random() * 0.4 - 0.2; // ¬±20%
                                nextDelay = delay * (1 + variation);
                                nextDelay = Math.max(100, Math.min(nextDelay, 10000));
                            }
                            
                            nextClickTime = currentTime + nextDelay;
                        }, 50); // Check every 50ms for precision
                        break;
                        
                    case 'stop':
                        clearInterval(timer);
                        self.postMessage({ type: 'stopped' });
                        break;
                        
                    case 'pause':
                        clearInterval(timer);
                        self.postMessage({ type: 'paused' });
                        break;
                        
                    case 'update':
                        if (timer && data.delay) {
                            clearInterval(timer);
                            const { delay, useAI } = data;
                            nextClickTime = Date.now() + delay;
                            
                            timer = setInterval(() => {
                                operationId++;
                                const currentTime = Date.now();
                                const timeUntilNext = nextClickTime - currentTime;
                                
                                self.postMessage({
                                    type: 'tick',
                                    operationId,
                                    timestamp: currentTime,
                                    timeUntilNext: Math.max(0, timeUntilNext)
                                });
                                
                                let nextDelay = delay;
                                if (useAI) {
                                    const variation = Math.random() * 0.4 - 0.2;
                                    nextDelay = delay * (1 + variation);
                                    nextDelay = Math.max(100, Math.min(nextDelay, 10000));
                                }
                                
                                nextClickTime = currentTime + nextDelay;
                            }, 50);
                        }
                        break;
                }
            };
        `;

        const workerBlob = new Blob([workerCode], { type: 'application/javascript' });
        const worker = new Worker(URL.createObjectURL(workerBlob));

        // ============================================
        // ENTERPRISE INDEXEDDB
        // ============================================
        let db = null;

        async function initIndexedDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(CONFIG.INDEXEDDB_NAME, CONFIG.INDEXEDDB_VERSION);
                
                request.onupgradeneeded = function(event) {
                    db = event.target.result;
                    
                    // Create object stores if they don't exist
                    if (!db.objectStoreNames.contains('operations')) {
                        const operationsStore = db.createObjectStore('operations', { 
                            keyPath: 'id',
                            autoIncrement: true 
                        });
                        operationsStore.createIndex('timestamp', 'timestamp', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains('settings')) {
                        db.createObjectStore('settings', { keyPath: 'key' });
                    }
                    
                    if (!db.objectStoreNames.contains('logs')) {
                        const logsStore = db.createObjectStore('logs', {
                            keyPath: 'id',
                            autoIncrement: true
                        });
                        logsStore.createIndex('timestamp', 'timestamp', { unique: false });
                        logsStore.createIndex('type', 'type', { unique: false });
                    }
                    
                    if (!db.objectStoreNames.contains('statistics')) {
                        db.createObjectStore('statistics', { keyPath: 'key' });
                    }
                };
                
                request.onsuccess = function(event) {
                    db = event.target.result;
                    updateDBStatus('IndexedDB Ready');
                    resolve(db);
                };
                
                request.onerror = function(event) {
                    updateDBStatus('IndexedDB Failed');
                    reject(new Error('IndexedDB initialization failed'));
                };
            });
        }

        async function saveToIndexedDB(storeName, data) {
            if (!db || !document.getElementById('useIndexedDB').checked) return;
            
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const store = transaction.objectStore(storeName);
                
                const request = store.put(data);
                
                request.onsuccess = () => resolve(true);
                request.onerror = () => resolve(false);
            });
        }

        async function getFromIndexedDB(storeName, key) {
            if (!db || !document.getElementById('useIndexedDB').checked) return null;
            
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readonly');
                const store = transaction.objectStore(storeName);
                
                const request = store.get(key);
                
                request.onsuccess = () => resolve(request.result ? request.result.value : null);
                request.onerror = () => resolve(null);
            });
        }

        async function saveOperationLog(operation) {
            if (!db || !document.getElementById('useIndexedDB').checked) return;
            
            const logEntry = {
                type: 'operation',
                message: `Operation #${operation.id} executed`,
                timestamp: Date.now(),
                data: operation
            };
            
            await saveToIndexedDB('logs', logEntry);
        }

        // ============================================
        // ENTERPRISE STATE MANAGEMENT
        // ============================================
        const State = {
            // Core State
            isRunning: false,
            isPaused: false,
            totalOperations: 0,
            successfulOperations: 0,
            failedOperations: 0,
            startTime: null,
            lastOperationTime: null,
            nextOperationTime: null,
            
            // Performance
            heartbeat: 0,
            performanceScore: 100,
            operationHistory: [],
            
            // Thread Management
            useWebWorker: true,
            useIndexedDB: true,
            activeThreads: 1,
            
            // Timing
            intervals: [],
            timeouts: [],
            currentOperationId: 0,
            
            // Settings Cache
            currentDelay: 2000,
            maxOperations: 100,
            targetURL: 'https://example.com',
            openIn: '_blank'
        };

        // ============================================
        // DOM ELEMENTS
        // ============================================
        const Elements = {
            // Stats
            totalClicks: document.getElementById('totalClicks'),
            status: document.getElementById('status'),
            sessionTime: document.getElementById('sessionTime'),
            successRate: document.getElementById('successRate'),
            failedClicks: document.getElementById('failedClicks'),
            uptime: document.getElementById('uptime'),
            totalTime: document.getElementById('totalTime'),
            
            // Health
            healthStatus: document.getElementById('healthStatus'),
            heartbeat: document.getElementById('heartbeat'),
            performanceScore: document.getElementById('performanceScore'),
            
            // Progress
            clickProgress: document.getElementById('clickProgress'),
            
            // Controls
            startBtn: document.getElementById('startBtn'),
            stopBtn: document.getElementById('stopBtn'),
            testLink: document.getElementById('testLink'),
            
            // Settings Display
            savedClicks: document.getElementById('savedClicks'),
            lastSaved: document.getElementById('lastSaved'),
            storageUsed: document.getElementById('storageUsed'),
            dbStatus: document.getElementById('dbStatus'),
            threadStatus: document.getElementById('threadStatus'),
            linkTargetPreview: document.getElementById('linkTargetPreview'),
            nextClickTimer: document.getElementById('nextClickTimer'),
            speedValue: document.getElementById('speedValue'),
            
            // Logs
            activityLog: document.getElementById('activityLog'),
            
            // Notifications
            dataStatus: document.getElementById('dataStatus')
        };

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Initialize IndexedDB
                await initIndexedDB();
                
                // Load saved data
                await loadAllData();
                
                // Setup Web Worker
                setupWebWorker();
                
                // Setup event listeners
                setupEventListeners();
                
                // Start system services
                startHeartbeat();
                startAutoSave();
                startPerformanceMonitor();
                
                // Update UI
                updateTargetLink();
                updateStorageInfo();
                
                // Initial log
                logSystem('üöÄ Ultimate Automation Powerhouse v3.0 Initialized', 'success');
                logSystem('ü§ñ Web Worker: Active', 'info');
                logSystem('üóÑÔ∏è IndexedDB: Ready', 'info');
                logSystem('üõ°Ô∏è Security: Enabled', 'info');
                
                showDataStatus('System Ready - Enterprise Mode Active', 'success');
                
            } catch (error) {
                logSystem(`‚ùå Initialization failed: ${error.message}`, 'error');
                showDataStatus('System Initialization Failed', 'error');
            }
        });

        // ============================================
        // WEB WORKER MANAGEMENT
        // ============================================
        function setupWebWorker() {
            worker.onmessage = function(event) {
                const { type, operationId, timestamp, timeUntilNext } = event.data;
                
                switch(type) {
                    case 'tick':
                        if (State.isRunning && !State.isPaused) {
                            State.nextOperationTime = timestamp + timeUntilNext;
                            Elements.nextClickTimer.textContent = (timeUntilNext / 1000).toFixed(1);
                            
                            if (timeUntilNext <= 0) {
                                executeAutomatedClick(operationId);
                            }
                        }
                        break;
                        
                    case 'stopped':
                        logSystem('‚èπÔ∏è Web Worker stopped', 'info');
                        break;
                        
                    case 'paused':
                        logSystem('‚è∏Ô∏è Web Worker paused', 'info');
                        break;
                }
            };
        }

        // ============================================
        // CORE AUTOMATION ENGINE
        // ============================================
        function executeAutomatedClick(operationId) {
            if (!State.isRunning || State.isPaused) return;
            
            const maxOperations = parseInt(document.getElementById('maxClicks').value);
            
            // Check max operations
            if (maxOperations > 0 && State.totalOperations >= maxOperations) {
                logSystem(`‚úÖ Maximum operations reached (${maxOperations})`, 'success');
                stopAutomation();
                return;
            }
            
            State.currentOperationId = operationId;
            State.totalOperations++;
            State.lastOperationTime = Date.now();
            
            try {
                // Get current settings
                const targetUrl = document.getElementById('targetUrl').value;
                const openIn = document.getElementById('openInNewTab').value;
                
                // Update link
                Elements.testLink.href = targetUrl;
                Elements.testLink.target = openIn;
                
                // Execute the click
                if (document.getElementById('stealthMode').checked) {
                    // Stealth mode - programmatic navigation
                    if (openIn === '_blank') {
                        window.open(targetUrl, '_blank', 'noopener,noreferrer');
                    } else {
                        window.location.href = targetUrl;
                    }
                } else {
                    // Normal mode - simulate click
                    const clickEvent = new MouseEvent('click', {
                        view: window,
                        bubbles: true,
                        cancelable: true
                    });
                    Elements.testLink.dispatchEvent(clickEvent);
                }
                
                State.successfulOperations++;
                
                // Update UI
                updateDashboard();
                
                // Log operation
                logOperation(`‚úÖ Operation #${State.totalOperations} executed`, 'success');
                
                // Save operation to IndexedDB
                if (document.getElementById('useIndexedDB').checked) {
                    saveOperationLog({
                        id: operationId,
                        timestamp: Date.now(),
                        type: 'click',
                        url: targetUrl,
                        success: true
                    });
                }
                
                // Play sound if enabled
                if (document.getElementById('soundEffects').checked) {
                    playSound('click');
                }
                
                // Show notification if enabled
                if (document.getElementById('notifications').checked) {
                    showNotification(`Operation #${State.totalOperations} completed`);
                }
                
                // AI Performance optimization
                if (document.getElementById('aiOptimization').checked) {
                    optimizePerformance();
                }
                
            } catch (error) {
                State.failedOperations++;
                logOperation(`‚ùå Operation #${State.totalOperations} failed: ${error.message}`, 'error');
                
                if (document.getElementById('soundEffects').checked) {
                    playSound('error');
                }
            }
            
            // Update progress
            if (maxOperations > 0) {
                const progress = (State.totalOperations / maxOperations) * 100;
                Elements.clickProgress.style.width = `${Math.min(progress, 100)}%`;
            }
        }

        // ============================================
        // AUTOMATION CONTROL
        // ============================================
        function startAutomation() {
            if (State.isRunning) return;
            
            State.isRunning = true;
            State.isPaused = false;
            State.startTime = Date.now();
            State.totalOperations = 0;
            State.successfulOperations = 0;
            State.failedOperations = 0;
            
            // Update UI
            Elements.startBtn.disabled = true;
            Elements.stopBtn.disabled = false;
            Elements.status.innerHTML = '<span class="status-indicator status-running"></span> RUNNING';
            Elements.status.style.color = '#48bb78';
            Elements.healthStatus.textContent = 'RUNNING';
            Elements.healthStatus.style.color = '#68d391';
            
            // Get settings
            const delay = parseInt(document.getElementById('clickDelay').value);
            const useWebWorker = document.getElementById('useWebWorker').checked;
            const useAI = document.getElementById('aiOptimization').checked;
            
            State.currentDelay = delay;
            State.useWebWorker = useWebWorker;
            
            logSystem('üöÄ Automation Engine Started', 'success');
            logSystem(`‚ö° Speed: ${delay}ms | ü§ñ Worker: ${useWebWorker ? 'Enabled' : 'Disabled'}`, 'info');
            
            // Save session
            saveSession();
            
            // Start timing
            if (useWebWorker) {
                worker.postMessage({
                    cmd: 'start',
                    data: { delay, useAI }
                });
                Elements.threadStatus.textContent = 'Web Worker Active';
                logSystem('ü§ñ Web Worker Timer Started', 'success');
            } else {
                // Fallback to traditional setTimeout
                startTraditionalTimer(delay);
                Elements.threadStatus.textContent = 'Traditional Timer';
                logSystem('‚è∞ Traditional Timer Started', 'info');
            }
            
            // Start session timer
            State.intervals.push(setInterval(updateSessionTimer, 1000));
            
            // Show notification
            if (document.getElementById('notifications').checked) {
                showNotification('Automation Started');
            }
        }

        function startTraditionalTimer(delay) {
            function execute() {
                if (!State.isRunning || State.isPaused) return;
                
                executeAutomatedClick(++State.currentOperationId);
                
                // Calculate next delay with randomization
                let nextDelay = delay;
                if (document.getElementById('randomDelay').checked) {
                    const variation = Math.random() * 0.4 - 0.2; // ¬±20%
                    nextDelay = delay * (1 + variation);
                    nextDelay = Math.max(CONFIG.MIN_DELAY, Math.min(nextDelay, CONFIG.MAX_DELAY));
                }
                
                // AI optimization
                if (document.getElementById('aiOptimization').checked) {
                    nextDelay = optimizeDelay(nextDelay);
                }
                
                State.nextOperationTime = Date.now() + nextDelay;
                
                // Schedule next execution
                if (State.isRunning && !State.isPaused) {
                    State.timeouts.push(setTimeout(execute, nextDelay));
                }
            }
            
            // Start first execution
            const initialDelay = 1000; // 1 second initial delay
            State.timeouts.push(setTimeout(execute, initialDelay));
        }

        function stopAutomation() {
            if (!State.isRunning) return;
            
            State.isRunning = false;
            State.isPaused = false;
            
            // Update UI
            Elements.startBtn.disabled = false;
            Elements.stopBtn.disabled = true;
            Elements.status.innerHTML = '<span class="status-indicator status-stopped"></span> STOPPED';
            Elements.status.style.color = '#f56565';
            Elements.healthStatus.textContent = 'STOPPED';
            Elements.healthStatus.style.color = '#f56565';
            Elements.nextClickTimer.textContent = '--';
            
            // Stop Web Worker
            if (State.useWebWorker) {
                worker.postMessage({ cmd: 'stop' });
            }
            
            // Clear all timeouts and intervals
            State.timeouts.forEach(timeout => clearTimeout(timeout));
            State.intervals.forEach(interval => clearInterval(interval));
            State.timeouts = [];
            State.intervals = [];
            
            // Calculate session duration
            if (State.startTime) {
                const sessionDuration = Math.floor((Date.now() - State.startTime) / 1000);
                const hours = Math.floor(sessionDuration / 3600);
                const minutes = Math.floor((sessionDuration % 3600) / 60);
                const seconds = sessionDuration % 60;
                
                logSystem(`‚èπÔ∏è Automation Stopped | Duration: ${hours}h ${minutes}m ${seconds}s`, 'warning');
                logSystem(`üìä Summary: ${State.totalOperations} total, ${State.successfulOperations} successful, ${State.failedOperations} failed`, 'info');
            }
            
            // Save final state
            saveSession();
            
            // Show notification
            if (document.getElementById('notifications').checked) {
                showNotification('Automation Stopped');
            }
        }

        function pauseAutomation() {
            if (!State.isRunning) return;
            
            State.isPaused = !State.isPaused;
            
            if (State.isPaused) {
                logSystem('‚è∏Ô∏è Automation Paused', 'warning');
                if (State.useWebWorker) {
                    worker.postMessage({ cmd: 'pause' });
                }
            } else {
                logSystem('‚ñ∂Ô∏è Automation Resumed', 'success');
                if (State.useWebWorker) {
                    const delay = parseInt(document.getElementById('clickDelay').value);
                    const useAI = document.getElementById('aiOptimization').checked;
                    worker.postMessage({
                        cmd: 'start',
                        data: { delay, useAI }
                    });
                }
            }
        }

        // ============================================
        // AI OPTIMIZATION
        // ============================================
        function optimizePerformance() {
            if (!document.getElementById('aiOptimization').checked) return;
            
            // Analyze recent performance
            const recentOperations = State.operationHistory.slice(-10);
            if (recentOperations.length < 5) return;
            
            const successRate = recentOperations.filter(op => op.success).length / recentOperations.length;
            const avgDelay = recentOperations.reduce((sum, op) => sum + op.delay, 0) / recentOperations.length;
            
            // Adjust settings based on performance
            if (successRate < 0.8) {
                // Poor success rate - increase delay
                const newDelay = Math.min(State.currentDelay * 1.3, CONFIG.MAX_DELAY);
                if (newDelay !== State.currentDelay) {
                    updateDelay(newDelay);
                    logSystem(`ü§ñ AI: Poor success rate (${(successRate*100).toFixed(1)}%), increasing delay to ${newDelay}ms`, 'ai');
                }
            } else if (successRate > 0.95 && State.currentDelay > CONFIG.MIN_DELAY * 2) {
                // Excellent success rate - try to decrease delay
                const newDelay = Math.max(State.currentDelay * 0.8, CONFIG.MIN_DELAY);
                if (newDelay !== State.currentDelay) {
                    updateDelay(newDelay);
                    logSystem(`ü§ñ AI: Excellent success rate (${(successRate*100).toFixed(1)}%), decreasing delay to ${newDelay}ms`, 'ai');
                }
            }
        }

        function optimizeDelay(currentDelay) {
            if (!document.getElementById('aiOptimization').checked) return currentDelay;
            
            // Analyze operation history for patterns
            if (State.operationHistory.length > 20) {
                const recentHistory = State.operationHistory.slice(-20);
                const failurePattern = recentHistory.filter(op => !op.success).length / recentHistory.length;
                
                if (failurePattern > 0.3) {
                    // High failure rate - increase delay significantly
                    return Math.min(currentDelay * 1.5, CONFIG.MAX_DELAY);
                } else if (failurePattern < 0.1 && currentDelay > CONFIG.MIN_DELAY * 1.5) {
                    // Low failure rate - try to speed up
                    return Math.max(currentDelay * 0.7, CONFIG.MIN_DELAY);
                }
            }
            
            return currentDelay;
        }

        function updateDelay(newDelay) {
            State.currentDelay = newDelay;
            document.getElementById('clickDelay').value = newDelay;
            updateSpeedValue(newDelay);
            
            if (State.isRunning && State.useWebWorker) {
                const useAI = document.getElementById('aiOptimization').checked;
                worker.postMessage({
                    cmd: 'update',
                    data: { delay: newDelay, useAI }
                });
            }
            
            saveSettings();
        }

        // ============================================
        // DASHBOARD & UI UPDATES
        // ============================================
        function updateDashboard() {
            // Update counters
            Elements.totalClicks.textContent = State.totalOperations;
            
            // Update success rate
            const totalAttempts = State.totalOperations;
            const successRate = totalAttempts > 0 ? 
                Math.round((State.successfulOperations / totalAttempts) * 100) : 100;
            Elements.successRate.textContent = `${successRate}%`;
            Elements.failedClicks.textContent = `Failed: ${State.failedOperations}`;
            
            // Update saved count
            Elements.savedClicks.textContent = `(IndexedDB: ${State.successfulOperations})`;
            
            // Update performance score
            State.performanceScore = successRate;
            Elements.performanceScore.textContent = `${successRate}%`;
        }

        function updateSessionTimer() {
            if (State.startTime) {
                const elapsed = Math.floor((Date.now() - State.startTime) / 1000);
                Elements.sessionTime.textContent = `${elapsed}s`;
                
                const hours = Math.floor(elapsed / 3600);
                const minutes = Math.floor((elapsed % 3600) / 60);
                const seconds = elapsed % 60;
                Elements.uptime.textContent = `Uptime: ${hours}h ${minutes}m ${seconds}s`;
            }
        }

        function updateTargetLink() {
            const url = document.getElementById('targetUrl').value;
            const target = document.getElementById('openInNewTab').value;
            
            Elements.testLink.href = url;
            Elements.testLink.target = target;
            
            const targetText = target === '_blank' ? 'New Tab' : 
                             target === '_self' ? 'Same Tab' : 'Parent Frame';
            Elements.linkTargetPreview.textContent = targetText;
            
            State.targetURL = url;
            State.openIn = target;
        }

        function updateSpeedValue(value) {
            Elements.speedValue.textContent = `${value}ms`;
        }

        function updateDBStatus(status) {
            Elements.dbStatus.textContent = status;
            Elements.dbStatus.style.color = status.includes('Ready') ? '#68d391' : '#f56565';
        }

        // ============================================
        // DATA MANAGEMENT
        // ============================================
        async function loadAllData() {
            try {
                // Load from localStorage first
                const savedClicks = localStorage.getItem('automation_clicks');
                if (savedClicks) {
                    State.totalOperations = parseInt(savedClicks);
                    Elements.totalClicks.textContent = State.totalOperations;
                }
                
                // Load settings
                const savedSettings = localStorage.getItem('automation_settings');
                if (savedSettings) {
                    const settings = JSON.parse(savedSettings);
                    document.getElementById('clickDelay').value = settings.clickDelay || 2000;
                    document.getElementById('maxClicks').value = settings.maxClicks || 100;
                    document.getElementById('targetUrl').value = settings.targetUrl || 'https://example.com';
                    document.getElementById('openInNewTab').value = settings.openInNewTab || '_blank';
                    document.getElementById('autoResume').checked = settings.autoResume !== false;
                    document.getElementById('saveLogs').checked = settings.saveLogs !== false;
                    document.getElementById('notifications').checked = settings.notifications !== false;
                    document.getElementById('randomDelay').checked = settings.randomDelay !== false;
                    document.getElementById('autoSave').checked = settings.autoSave !== false;
                    document.getElementById('soundEffects').checked = settings.soundEffects || false;
                    document.getElementById('useIndexedDB').checked = settings.useIndexedDB !== false;
                    document.getElementById('useWebWorker').checked = settings.useWebWorker !== false;
                    document.getElementById('stealthMode').checked = settings.stealthMode || false;
                    document.getElementById('aiOptimization').checked = settings.aiOptimization !== false;
                    
                    State.useIndexedDB = document.getElementById('useIndexedDB').checked;
                    State.useWebWorker = document.getElementById('useWebWorker').checked;
                }
                
                // Load from IndexedDB if enabled
                if (State.useIndexedDB && db) {
                    const savedStats = await getFromIndexedDB('statistics', 'operations');
                    if (savedStats) {
                        State.totalOperations = savedStats.total || 0;
                        State.successfulOperations = savedStats.successful || 0;
                        State.failedOperations = savedStats.failed || 0;
                        updateDashboard();
                    }
                }
                
                // Load last saved timestamp
                const lastSaved = localStorage.getItem('last_saved_timestamp');
                if (lastSaved) {
                    Elements.lastSaved.textContent = new Date(parseInt(lastSaved)).toLocaleTimeString();
                }
                
                logSystem('üìÇ All data loaded successfully', 'success');
            } catch (error) {
                logSystem(`‚ùå Error loading data: ${error.message}`, 'error');
            }
        }

        async function saveSettings() {
            try {
                const settings = {
                    clickDelay: document.getElementById('clickDelay').value,
                    maxClicks: document.getElementById('maxClicks').value,
                    targetUrl: document.getElementById('targetUrl').value,
                    openInNewTab: document.getElementById('openInNewTab').value,
                    autoResume: document.getElementById('autoResume').checked,
                    saveLogs: document.getElementById('saveLogs').checked,
                    notifications: document.getElementById('notifications').checked,
                    randomDelay: document.getElementById('randomDelay').checked,
                    autoSave: document.getElementById('autoSave').checked,
                    soundEffects: document.getElementById('soundEffects').checked,
                    useIndexedDB: document.getElementById('useIndexedDB').checked,
                    useWebWorker: document.getElementById('useWebWorker').checked,
                    stealthMode: document.getElementById('stealthMode').checked,
                    aiOptimization: document.getElementById('aiOptimization').checked,
                    lastUpdated: new Date().toISOString()
                };
                
                localStorage.setItem('automation_settings', JSON.stringify(settings));
                
                if (State.useIndexedDB && db) {
                    await saveToIndexedDB('settings', {
                        key: 'user_settings',
                        value: settings,
                        timestamp: Date.now()
                    });
                }
                
                logSystem('‚öôÔ∏è Settings saved', 'info');
                return true;
            } catch (error) {
                logSystem(`‚ùå Error saving settings: ${error.message}`, 'error');
                return false;
            }
        }

        async function saveSession() {
            try {
                // Save to localStorage
                localStorage.setItem('automation_clicks', State.totalOperations.toString());
                localStorage.setItem('automation_session', JSON.stringify({
                    active: State.isRunning,
                    startTime: State.startTime,
                    totalOperations: State.totalOperations,
                    successfulOperations: State.successfulOperations,
                    failedOperations: State.failedOperations,
                    lastUpdate: Date.now()
                }));
                
                // Save to IndexedDB if enabled
                if (State.useIndexedDB && db) {
                    await saveToIndexedDB('statistics', {
                        key: 'operations',
                        value: {
                            total: State.totalOperations,
                            successful: State.successfulOperations,
                            failed: State.failedOperations,
                            lastUpdated: Date.now()
                        },
                        timestamp: Date.now()
                    });
                }
                
                // Update timestamp
                const now = Date.now();
                localStorage.setItem('last_saved_timestamp', now.toString());
                Elements.lastSaved.textContent = new Date(now).toLocaleTimeString();
                
                return true;
            } catch (error) {
                logSystem(`‚ùå Error saving session: ${error.message}`, 'error');
                return false;
            }
        }

        // ============================================
        // LOGGING SYSTEM
        // ============================================
        function logSystem(message, type = 'info') {
            logToDisplay(message, type, 'system');
        }

        function logOperation(message, type = 'info') {
            logToDisplay(message, type, 'operation');
            
            // Add to operation history for AI analysis
            if (type === 'success' || type === 'error') {
                State.operationHistory.push({
                    timestamp: Date.now(),
                    success: type === 'success',
                    delay: State.currentDelay
                });
                
                // Keep history manageable
                if (State.operationHistory.length > 100) {
                    State.operationHistory.shift();
                }
            }
        }

        function logToDisplay(message, type = 'info', source = 'system') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            
            let icon = '‚ÑπÔ∏è';
            switch(type) {
                case 'success': icon = '‚úÖ'; break;
                case 'error': icon = '‚ùå'; break;
                case 'warning': icon = '‚ö†Ô∏è'; break;
                case 'ai': icon = 'ü§ñ'; break;
                case 'system': icon = 'üöÄ'; break;
            }
            
            logEntry.innerHTML = `
                <span class="log-time">${timestamp}</span>
                <span class="log-type log-type-${type}">${type.toUpperCase()}</span>
                ${icon} <span class="log-message">${message}</span>
            `;
            
            Elements.activityLog.prepend(logEntry);
            
            // Keep log manageable
            if (Elements.activityLog.children.length > 200) {
                Elements.activityLog.removeChild(Elements.activityLog.lastChild);
            }
            
            // Auto-scroll to top
            Elements.activityLog.scrollTop = 0;
            
            // Save to IndexedDB if enabled
            if (document.getElementById('saveLogs').checked && State.useIndexedDB && db) {
                saveToIndexedDB('logs', {
                    type,
                    source,
                    message,
                    timestamp: Date.now()
                });
            }
            
            // Play sound for errors
            if (type === 'error' && document.getElementById('soundEffects').checked) {
                playSound('error');
            }
        }

        // ============================================
        // SYSTEM SERVICES
        // ============================================
        function startHeartbeat() {
            setInterval(() => {
                State.heartbeat++;
                Elements.heartbeat.textContent = State.heartbeat;
                
                // Update health status based on performance
                if (State.isRunning) {
                    const health = State.performanceScore > 80 ? 'GOOD' : 
                                 State.performanceScore > 60 ? 'FAIR' : 'POOR';
                    Elements.healthStatus.textContent = health;
                    Elements.healthStatus.style.color = State.performanceScore > 80 ? '#68d391' :
                                                      State.performanceScore > 60 ? '#f6ad55' : '#f56565';
                }
            }, 1000);
        }

        function startAutoSave() {
            setInterval(() => {
                if (document.getElementById('autoSave').checked && State.isRunning) {
                    saveSession();
                    showDataStatus('Auto-saved', 'info', 1000);
                }
            }, 30000);
        }

        function startPerformanceMonitor() {
            setInterval(() => {
                if (State.isRunning) {
                    updateStorageInfo();
                }
            }, 5000);
        }

        function updateStorageInfo() {
            try {
                let totalSize = 0;
                for (let key in localStorage) {
                    if (localStorage.hasOwnProperty(key)) {
                        totalSize += localStorage[key].length * 2;
                    }
                }
                Elements.storageUsed.textContent = `${(totalSize / 1024).toFixed(2)} KB`;
            } catch (error) {
                Elements.storageUsed.textContent = 'Error';
            }
        }

        // ============================================
        // UI UTILITIES
        // ============================================
        function showDataStatus(message, type = 'info', duration = 3000) {
            Elements.dataStatus.textContent = message;
            Elements.dataStatus.style.background = type === 'success' ? '#48bb78' : 
                                                   type === 'error' ? '#f56565' : 
                                                   type === 'warning' ? '#ed8936' : '#4299e1';
            
            Elements.dataStatus.classList.add('show');
            
            setTimeout(() => {
                Elements.dataStatus.classList.remove('show');
            }, duration);
        }

        function showNotification(message) {
            if (!("Notification" in window)) return;
            
            if (Notification.permission === "granted") {
                new Notification("Ultimate Automation", {
                    body: message,
                    icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2348bb78"><path d="M0 0h24v24H0z" fill="none"/><path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7z"/></svg>'
                });
            } else if (Notification.permission !== "denied") {
                Notification.requestPermission();
            }
        }

        function playSound(type) {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                if (type === 'click') {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 1000;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                    
                } else if (type === 'error') {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 300;
                    oscillator.type = 'sawtooth';
                    
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                }
            } catch (error) {
                // Audio not supported - silent fail
            }
        }

        function toggleAdvanced() {
            const content = document.getElementById('advancedContent');
            const toggle = document.getElementById('advancedToggle');
            
            if (content.style.display === 'none') {
                content.style.display = 'grid';
                toggle.textContent = '‚ñ≤';
            } else {
                content.style.display = 'none';
                toggle.textContent = '‚ñº';
            }
        }

        // ============================================
        // DATA EXPORT/IMPORT
        // ============================================
        function exportData() {
            const data = {
                metadata: {
                    version: CONFIG.VERSION,
                    appName: CONFIG.APP_NAME,
                    exportDate: new Date().toISOString()
                },
                statistics: {
                    totalOperations: State.totalOperations,
                    successfulOperations: State.successfulOperations,
                    failedOperations: State.failedOperations,
                    performanceScore: State.performanceScore
                },
                settings: {
                    clickDelay: document.getElementById('clickDelay').value,
                    maxClicks: document.getElementById('maxClicks').value,
                    targetUrl: document.getElementById('targetUrl').value,
                    openInNewTab: document.getElementById('openInNewTab').value,
                    useIndexedDB: document.getElementById('useIndexedDB').checked,
                    useWebWorker: document.getElementById('useWebWorker').checked,
                    aiOptimization: document.getElementById('aiOptimization').checked
                },
                session: {
                    isRunning: State.isRunning,
                    startTime: State.startTime,
                    lastOperationTime: State.lastOperationTime
                },
                logs: Elements.activityLog.innerHTML
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const a = document.createElement('a');
            a.href = url;
            const dateStr = new Date().toISOString().split('T')[0];
            a.download = `automation-backup-${dateStr}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            logSystem('üíæ Complete backup exported', 'success');
            showDataStatus('Backup exported successfully', 'success');
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    try {
                        const data = JSON.parse(event.target.result);
                        
                        // Import statistics
                        if (data.statistics) {
                            State.totalOperations = data.statistics.totalOperations || 0;
                            State.successfulOperations = data.statistics.successfulOperations || 0;
                            State.failedOperations = data.statistics.failedOperations || 0;
                            State.performanceScore = data.statistics.performanceScore || 100;
                            updateDashboard();
                        }
                        
                        // Import settings
                        if (data.settings) {
                            document.getElementById('clickDelay').value = data.settings.clickDelay || 2000;
                            document.getElementById('maxClicks').value = data.settings.maxClicks || 100;
                            document.getElementById('targetUrl').value = data.settings.targetUrl || 'https://example.com';
                            document.getElementById('openInNewTab').value = data.settings.openInNewTab || '_blank';
                            document.getElementById('useIndexedDB').checked = data.settings.useIndexedDB !== false;
                            document.getElementById('useWebWorker').checked = data.settings.useWebWorker !== false;
                            document.getElementById('aiOptimization').checked = data.settings.aiOptimization !== false;
                            
                            State.useIndexedDB = document.getElementById('useIndexedDB').checked;
                            State.useWebWorker = document.getElementById('useWebWorker').checked;
                            updateTargetLink();
                            updateSpeedValue(data.settings.clickDelay || 2000);
                        }
                        
                        // Import logs
                        if (data.logs) {
                            Elements.activityLog.innerHTML = data.logs;
                        }
                        
                        // Save imported data
                        saveSettings();
                        saveSession();
                        
                        logSystem(`üì• Data imported from backup (${data.metadata?.exportDate || 'unknown'})`, 'success');
                        showDataStatus('Data imported successfully', 'success');
                        
                    } catch (error) {
                        logSystem('‚ùå Error importing data: Invalid file format', 'error');
                        showDataStatus('Import failed: Invalid file', 'error');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }

        function exportLogs() {
            const logs = Elements.activityLog.innerText;
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `automation-logs-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            logSystem('üì§ Logs exported', 'success');
            showDataStatus('Logs exported', 'success');
        }

        function clearLogs() {
            if (confirm('Clear all system logs?')) {
                Elements.activityLog.innerHTML = '';
                logSystem('üßπ All logs cleared', 'warning');
            }
        }

        function resetStats() {
            if (confirm('Reset all statistics and stop automation?')) {
                if (State.isRunning) {
                    stopAutomation();
                }
                
                State.totalOperations = 0;
                State.successfulOperations = 0;
                State.failedOperations = 0;
                State.performanceScore = 100;
                State.operationHistory = [];
                
                updateDashboard();
                Elements.clickProgress.style.width = '0%';
                
                // Clear localStorage
                localStorage.removeItem('automation_clicks');
                localStorage.removeItem('automation_session');
                
                // Clear IndexedDB if enabled
                if (State.useIndexedDB && db) {
                    const transaction = db.transaction(['statistics', 'logs'], 'readwrite');
                    transaction.objectStore('statistics').clear();
                    transaction.objectStore('logs').clear();
                }
                
                logSystem('üîÑ All statistics reset', 'warning');
                showDataStatus('Statistics reset', 'warning');
            }
        }

        // ============================================
        // EVENT LISTENERS
        // ============================================
        function setupEventListeners() {
            // Settings changes
            document.getElementById('targetUrl').addEventListener('input', updateTargetLink);
            document.getElementById('openInNewTab').addEventListener('change', updateTargetLink);
            
            document.getElementById('clickDelay').addEventListener('change', function() {
                const newDelay = parseInt(this.value);
                updateDelay(newDelay);
                logSystem(`‚ö° Speed changed to ${newDelay}ms`, 'info');
            });
            
            document.getElementById('maxClicks').addEventListener('change', function() {
                logSystem(`üéØ Max operations changed to ${this.value}`, 'info');
                saveSettings();
            });
            
            // Advanced settings
            const advancedSettings = [
                'autoResume', 'saveLogs', 'notifications', 'randomDelay',
                'autoSave', 'soundEffects', 'useIndexedDB', 'useWebWorker',
                'stealthMode', 'aiOptimization'
            ];
            
            advancedSettings.forEach(setting => {
                document.getElementById(setting).addEventListener('change', function() {
                    const label = this.nextElementSibling.textContent;
                    const status = this.checked ? 'enabled' : 'disabled';
                    logSystem(`‚öôÔ∏è ${label}: ${status}`, 'info');
                    saveSettings();
                    
                    // Special handling for Web Worker
                    if (setting === 'useWebWorker' && State.isRunning) {
                        if (this.checked) {
                            // Switch to Web Worker
                            const delay = parseInt(document.getElementById('clickDelay').value);
                            const useAI = document.getElementById('aiOptimization').checked;
                            worker.postMessage({
                                cmd: 'start',
                                data: { delay, useAI }
                            });
                            Elements.threadStatus.textContent = 'Web Worker Active';
                        } else {
                            // Switch to traditional timer
                            worker.postMessage({ cmd: 'stop' });
                            startTraditionalTimer(parseInt(document.getElementById('clickDelay').value));
                            Elements.threadStatus.textContent = 'Traditional Timer';
                        }
                    }
                });
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                // Space to toggle start/stop
                if (e.code === 'Space' && !e.target.matches('input, textarea, select')) {
                    e.preventDefault();
                    if (State.isRunning) {
                        stopAutomation();
                    } else {
                        startAutomation();
                    }
                }
                
                // Ctrl+S to start
                if ((e.ctrlKey || e.metaKey) && e.key === 's' && !State.isRunning) {
                    e.preventDefault();
                    startAutomation();
                }
                
                // Ctrl+P to pause
                if ((e.ctrlKey || e.metaKey) && e.key === 'p' && State.isRunning) {
                    e.preventDefault();
                    pauseAutomation();
                }
                
                // Escape to stop
                if (e.key === 'Escape' && State.isRunning) {
                    stopAutomation();
                }
                
                // Ctrl+E to export
                if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                    e.preventDefault();
                    exportData();
                }
                
                // Ctrl+I to import
                if ((e.ctrlKey || e.metaKey) && e.key === 'i') {
                    e.preventDefault();
                    importData();
                }
            });
            
            // Tab visibility
            document.addEventListener('visibilitychange', function() {
                if (document.hidden && State.isRunning) {
                    logSystem('üåô Browser tab hidden - automation continues', 'info');
                } else if (!document.hidden && State.isRunning) {
                    logSystem('‚òÄÔ∏è Browser tab active', 'info');
                }
            });
            
            // Before unload warning
            window.addEventListener('beforeunload', function(e) {
                if (State.isRunning) {
                    e.preventDefault();
                    e.returnValue = 'Automation is still running. Are you sure you want to leave?';
                    return e.returnValue;
                }
            });
        }

        // ============================================
        // INITIAL SYSTEM LOG
        // ============================================
        setTimeout(() => {
            logSystem('========================================', 'info');
            logSystem('üöÄ ULTIMATE AUTOMATION POWERHOUSE v3.0', 'success');
            logSystem('========================================', 'info');
            logSystem('ü§ñ AI Optimization: Ready', 'ai');
            logSystem('üóÑÔ∏è IndexedDB Storage: Active', 'info');
            logSystem('‚ö° Web Worker Threads: 1', 'info');
            logSystem('üõ°Ô∏è Security Protocols: Enabled', 'info');
            logSystem('üéØ Target: https://example.com', 'info');
            logSystem('‚öôÔ∏è Default Speed: 2000ms', 'info');
            logSystem('========================================', 'info');
            logSystem('Ready for automated operations...', 'success');
        }, 500);
    </script>
</body>
    </html>
